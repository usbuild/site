<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.42.1" />

  <title>ä½¿ç”¨ git bisect è¿›è¡Œdebug &middot; sysğŸ”±fork</title>

  
  
  <link rel="stylesheet" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="http://sysfork.com/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="http://sysfork.com/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="http://sysfork.com/css/blackburn.css">

  
  <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css">

  
  

  
  

  
  <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.4.0/styles/gruvbox-light.min.css">
  <script src="//cdn.bootcss.com/highlight.js/9.4.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="http://sysfork.com/img/favicon.ico" type="image/x-icon" />

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  

  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://sysfork.com/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://sysfork.com/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/usbuild" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/usbuild" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2018. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>ä½¿ç”¨ git bisect è¿›è¡Œdebug</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>11 Jul 2017, 16:11</time>
  </div>

  

  
  
  
  

  
  
  
  

</div>

  <p>æœ€è¿‘åœ¨å­¦ä¹ <code>git</code>çš„æ—¶å€™å‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„å‘½ä»¤ï¼Œ<code>git bisect</code>ã€‚è¿™ä¸ªå‘½ä»¤æ˜¯ debug ç”¨çš„ã€‚æˆ‘ä»¬å¾€å¾€åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¼•å…¥ä¸€äº›bugï¼Œä½†æ˜¯ç”±äºæ²¡èƒ½ç«‹å³æµ‹è¯•å¯¼è‡´è¿™äº›bugåœ¨å¾ˆå¤šæ¬¡æäº¤
ä¹‹åæ‰èƒ½è¢«å‘ç°ï¼Œä½†æ˜¯è¿™æ—¶å€™è·ç¦»ä¸Šæ¬¡å¼•å…¥çš„bugå¯èƒ½è¿‡å»äº†å¾ˆé•¿æ—¶é—´ï¼Œéš¾ä»¥å¤ç°äº†ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨svnçš„è¯ï¼Œå¾€å¾€ä¼šä¸æ–­åœ°<code>svn update</code>åˆ°æŸä¸ªç‰ˆæœ¬ç„¶åæµ‹è¯•ï¼Œä¸ºäº†æé«˜æœå¯»
å¾—æ•ˆç‡å¾€å¾€ä¼šä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼šåœ¨å·²çŸ¥çš„åŠŸèƒ½æ­£å¸¸çš„ç‰ˆæœ¬Aå’Œå½“å‰ç‰ˆæœ¬Bæ‰¾ä¸€ä¸ªä¸­é—´ç‚¹Cåˆ¤æ–­ï¼Œå¦‚æœCç‰ˆæœ¬ä¹Ÿæ˜¯å­˜åœ¨bugçš„è¯ç»§ç»­æœç´¢ACåŒºé—´ï¼Œå¦åˆ™çš„è¯æœç´¢CBåŒºé—´ã€‚åœ¨ git ä¸­ï¼Œ
è¿™ä¸ªæ“ä½œå¯ä»¥è¢«è‡ªåŠ¨åŒ–ï¼Œ<code>bisect</code>æŒ‡ä»¤å°±æ˜¯ä¸“é—¨ç”¨ä½œè¿™ä¸ªçš„ã€‚</p>

<p>ä¸‹é¢æˆ‘æ¥ç®€å•ä»‹ç»ä¸€ä¸‹è¿™ä¸ªç”¨æ³•ã€‚</p>

<p>å‡è®¾æœ‰ä¸€ä¸ª git åº“ï¼Œä½¿ç”¨å¦‚ä¸‹çš„æ–¹å¼æ„å»ºï¼š</p>

<pre><code>âœ  test git init
Initialized empty Git repository in /home/zqc/workspace/test/.git/
âœ  test git:(master) for i in {1..10}; do echo $i &gt;&gt; test.log; git add -A; git commit -m &quot;commit $i&quot;; done
[master (root-commit) cc9d416] commit 1
 1 file changed, 1 insertion(+)
 create mode 100644 test.log
[master 09576a2] commit 2
 1 file changed, 1 insertion(+)
[master 9cfabe6] commit 3
 1 file changed, 1 insertion(+)
[master f65497a] commit 4
 1 file changed, 1 insertion(+)
[master 6292639] commit 5
 1 file changed, 1 insertion(+)
[master 301e6fd] commit 6
 1 file changed, 1 insertion(+)
[master b440342] commit 7
 1 file changed, 1 insertion(+)
[master a4f2dea] commit 8
 1 file changed, 1 insertion(+)
[master 8d8ec0a] commit 9
 1 file changed, 1 insertion(+)
[master 474b493] commit 10
 1 file changed, 1 insertion(+)
</code></pre>

<p>å…¶ä½œç”¨æ˜¯åˆå§‹åŒ–äº†ä¸€ä¸ªgitä»“åº“ï¼Œå¹¶æäº¤äº†10æ¬¡ï¼Œæ¯æ¬¡è±†é¦™<code>test.log</code>æ–‡ä»¶æœ«å°¾å¢åŠ äº†ä¸€ä¸ªæ•°å­—ã€‚
æ‰€ä»¥<code>test.log</code>æœ€ç»ˆçš„å†…å®¹æ˜¯ï¼š</p>

<pre><code>1
2
3
4
5
6
7
8
9
10
</code></pre>

<p>æˆ‘ä»¬å‡è®¾å¦‚æœè¿™ä¸ªæ–‡ä»¶ä¸­æ‰€æœ‰æ•°å­—çš„å’Œè¶…è¿‡<code>30</code>ï¼Œé‚£ä¹ˆè¿™ä¸ªç¨‹åºå°±æ˜¯æœ‰bugçš„ï¼Œç°åœ¨æˆ‘ä»¬æƒ³åˆ¤æ–­æ˜¯å“ªæ¬¡æäº¤å¯¼è‡´å’Œè¶…è¿‡äº†<code>30</code>ã€‚</p>

<p>å…ˆè¦å¼€å§‹äºŒåˆ†æŸ¥æ‰¾<code>git bisect start</code>ã€‚</p>

<p>ç°åœ¨æˆ‘ä»¬å¤„äºHEADå¤„ã€‚æ­¤æ—¶å’Œä¸º<code>1 + 2 + ... + 10 = 55 &gt; 30</code>ï¼Œæ‰€ä»¥å½“å‰æ˜¯æœ‰bugçš„ï¼Œå› æ­¤è®¾ç½®å½“å‰çš„è¿™æ¬¡æäº¤ä¸º<code>bad</code>, <code>git bisect bad</code>
æ˜¾ç„¶åœ¨ç¬¬ä¸€æ¬¡æäº¤ä¸­ï¼Œå’Œä¸º1ï¼Œæ‰€ä»¥å…¶åº”è¯¥æ˜¯æ­£å¸¸çš„<code>good</code>ï¼Œå› æ­¤è®¾ç½®ç¬¬ä¸€æ¬¡æäº¤<code>git bisect good cc9d416</code>ã€‚</p>

<p>å½“æˆ‘ä»¬æ•²ä¸‹è¿™æ¡æŒ‡ä»¤æ˜¯ï¼Œgitä¼šå°†å½“å‰çš„HEADæŒ‡é’ˆè®¾ç½®ä¸ºï¼š</p>

<pre><code>âœ  test git:(6292639) git rev-parse HEAD
6292639374ed862233630d2803031f9624e1fa0c
âœ  test git:(6292639) git log -1
commit 6292639374ed862233630d2803031f9624e1fa0c
Author: usbuild &lt;xxx@gmail.com&gt;
Date:   Tue Jul 11 17:11:08 2017 +0800

    commit 5
</code></pre>

<p>å¯ä»¥çœ‹å‡ºæ˜¯ç¬¬5æ¬¡æäº¤ï¼Œæ­¤æ—¶æˆ‘ä»¬è®¡ç®—<code>test.log</code>å’Œä¸º<code>1 + 2 + .. + 5 = 15 &lt; 30</code>ï¼Œæ‰€ä»¥æ­¤æ¬¡æäº¤æ—¶å¥½çš„ï¼Œé‚£ä¹ˆæ ‡è¯†<code>git bisect good</code>ã€‚ç„¶ååŒä¸Šï¼Œgit
å°†HEADå¸¦åˆ°äº†ç¬¬7æ¬¡æäº¤ã€‚åŒæ ·<code>1 + 2 + ... + 7 = 28 &lt; 30</code>ï¼Œä¹Ÿæ˜¯åˆæ³•çš„ï¼Œç»§ç»­è®¾ç½®ä¸º<code>good</code>ã€‚ç„¶ååˆ°<code>9</code>ï¼Œè¿™æ—¶å’Œå·²ç»è¶…è¿‡<code>30</code>äº†ï¼Œæ‰€ä»¥ä¸º<code>bad</code>ã€‚åˆ°<code>8</code>ï¼Œä¹Ÿæ˜¯<code>bad</code>ã€‚
è¿™æ—¶ï¼Œgitä¼šå¼¹å‡ºæœç´¢çš„ç»“æœï¼š</p>

<pre><code>a4f2deaa73f28dffe4cdfb72258d14815cacf185 is the first bad commit
commit a4f2deaa73f28dffe4cdfb72258d14815cacf185
Author: usbuild &lt;xxx@gmail.com&gt;
Date:   Tue Jul 11 17:11:08 2017 +0800

    commit 8

:100644 100644 06e567b11dfdafeaf7d3edcc89864149383aeab6 535d2b01d3397c2228490875defc92370602ca46 M      test.log
</code></pre>

<p>å®ƒæ ‡è¯†å¤„ç¬¬8æ¬¡æäº¤å¼•å…¥äº†è¿™ä¸ªé—®é¢˜ï¼Œè¿™ä¹Ÿæ­£æ˜¯ç¬¦åˆå®é™…çš„ã€‚</p>

<p>å½“æ‰¾åˆ°è¿™æ¬¡æäº¤ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨<code>git bisect reset</code>æ¥æ¢å¤å½“å‰çš„å·¥ä½œåŒºã€‚è‡³æ­¤æŸ¥æ‰¾å·¥ä½œå®Œæˆã€‚</p>

<p>è™½ç„¶è¯´åœ¨ä¸Šè¿°è¿‡ç¨‹ä¸­æˆ‘ä»¬ä¸éœ€è¦æ‰‹åŠ¨è®¡ç®—ä¸­é—´ç‰ˆæœ¬äº†ï¼Œä½†æ˜¯å¯¹äºéªŒè¯å·¥ä½œè¿˜æ˜¯éœ€è¦æ‰‹åŠ¨è®¡ç®—ï¼Œç¨æ˜¾éº»çƒ¦ã€‚å…¶å®å¦‚æœæœ‰è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬çš„è¯ï¼Œ<code>bisect</code>èƒ½è‡ªåŠ¨å¸®æˆ‘ä»¬æ‰¾åˆ°é—®é¢˜çš„æäº¤ã€‚
è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>

<pre><code>âœ  test git:(master) git bisect start
âœ  test git:(master) git bisect good cc9d416                                                                                      
âœ  test git:(master) git bisect bad
</code></pre>

<p>æŒ‡å®šèŒƒå›´åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>git bisect run &lt;cmd&gt;</code>æ¥å®ç°è‡ªåŠ¨æŸ¥æ‰¾ã€‚å½“<code>&lt;cmd&gt;</code>è¿”å›å€¼ä¸º<code>0</code>æ—¶ï¼Œæ ‡è¯†ä¸º<code>good</code>ï¼›å¦åˆ™ä¸º<code>bad</code>ã€‚è¿™é‡Œæˆ‘ä»¬å†™ä¸€ä¸ªç®€å•çš„åˆ¤æ–­è„šæœ¬</p>

<pre><code>âœ  test git:(6292639) git bisect run python -c &quot;assert(sum(int(x) for x in open('test.log', 'r').read().strip().split('\n')) &lt;= 30)&quot;
running python -c assert(sum(int(x) for x in open('test.log', 'r').read().strip().split('\n')) &lt;= 30)
Bisecting: 2 revisions left to test after this (roughly 1 step)
[b4403425313b8e4a65c7278d2b51ecfcb5a767a3] commit 7
running python -c assert(sum(int(x) for x in open('test.log', 'r').read().strip().split('\n')) &lt;= 30)
Bisecting: 0 revisions left to test after this (roughly 1 step)
[8d8ec0a7976a74d184602070fbe1c148cee49612] commit 9
running python -c assert(sum(int(x) for x in open('test.log', 'r').read().strip().split('\n')) &lt;= 30)
Traceback (most recent call last):
  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
Bisecting: 0 revisions left to test after this (roughly 0 steps)
[a4f2deaa73f28dffe4cdfb72258d14815cacf185] commit 8
running python -c assert(sum(int(x) for x in open('test.log', 'r').read().strip().split('\n')) &lt;= 30)
Traceback (most recent call last):
  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
a4f2deaa73f28dffe4cdfb72258d14815cacf185 is the first bad commit
commit a4f2deaa73f28dffe4cdfb72258d14815cacf185
Author: usbuild &lt;xxx@gmail.com&gt;
Date:   Tue Jul 11 17:11:08 2017 +0800

    commit 8

:100644 100644 06e567b11dfdafeaf7d3edcc89864149383aeab6 535d2b01d3397c2228490875defc92370602ca46 M      test.log
bisect run success
</code></pre>

<p>æœ€ç»ˆå‡ºæ¥çš„ç»“æœå’Œæˆ‘ä»¬ä¹‹å‰çš„åˆ¤æ–­æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡å‡å°‘äº†äººå·¥æ“ä½œçš„éº»çƒ¦ã€‚</p>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="http://sysfork.com/post/2017/use-semantic-ui-with-vue/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="http://sysfork.com/post/2017/use-semantic-ui-with-vue/">åœ¨ vue ä¸­ä½¿ç”¨ semantic-ui</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="http://sysfork.com/post/2017/starting-playwith-nodemcu/">å…¥æ‰‹ NodeMCU åŠåˆæ­¥ä½“éªŒ</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="http://sysfork.com/post/2017/starting-playwith-nodemcu/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'sysfork';
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

  
  
</div>

</div>
</div>
<script src="http://sysfork.com/js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19710645-12', 'auto');
  ga('send', 'pageview');

</script>


</script>
</body>
</html>

