<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Nodemcu on sysğŸ”±fork</title>
    <link>http://sysfork.com/tags/nodemcu/</link>
    <description>Recent content in Nodemcu on sysğŸ”±fork</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <copyright>&amp;copy; 2017. All rights reserved.</copyright>
    <lastBuildDate>Mon, 21 Aug 2017 20:14:01 +0800</lastBuildDate>
    <atom:link href="http://sysfork.com/tags/nodemcu/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>å…¥æ‰‹ NodeMCU åŠåˆæ­¥ä½“éªŒ</title>
      <link>http://sysfork.com/post/2017/starting-playwith-nodemcu/</link>
      <pubDate>Mon, 21 Aug 2017 20:14:01 +0800</pubDate>
      
      <guid>http://sysfork.com/post/2017/starting-playwith-nodemcu/</guid>
      <description>&lt;p&gt;æœ€è¿‘åˆ·å¾®åšçœ‹åˆ°æœ‰äººæåˆ° &lt;a href=&#34;http://www.nodemcu.com/&#34;&gt;NodeMCU&lt;/a&gt;ï¼Œ ç½‘ä¸Šä¸€æŸ¥æ‰å‘ç°å…¶å®æ˜¯ç±»ä¼¼äº &lt;a href=&#34;https://www.arduino.cc/&#34;&gt;Arduino&lt;/a&gt;çš„å¼€å‘æ¿ï¼Œä¸è¿‡
å®ƒä½¿ç”¨ lua ä½œä¸ºå¼€å‘è¯­è¨€ï¼Œç›¸å¯¹äº micropython å…¶å ç”¨å†…å­˜æ›´å°ï¼Œè¯­è¨€çš„æ ¸å¿ƒåº“ä¹Ÿå¾ˆç®€å•ã€‚ åŒæ—¶ï¼ŒNodeMCU é›†æˆäº† &lt;a href=&#34;http://espressif.com/zh-hans/products/hardware/esp8266ex/overview&#34;&gt;ESP8266&lt;/a&gt;
è¿™ç§å»‰ä»·çš„ WIFI èŠ¯ç‰‡ï¼Œä½¿å¾—å…¶æ”¯æŒä¸€å®šçš„ç½‘ç»œåŠŸèƒ½ã€‚å»æ·˜å®æœç´¢ä¸€ä¸‹&lt;/p&gt;

&lt;p&gt;&lt;center&gt;&lt;img src=&#34;http://sysfork.com/img/2017/nodemcu/taobao-search-nodemcu.png&#34; width=&#34;450px&#34;&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;ä»·æ ¼ä¹Ÿæ˜¯éå¸¸ä¾¿å®œã€‚æˆ‘éšä¾¿æ‰¾äº†ä¸€å®¶åº—é“ºä¹°äº†ä¸¤ä¸ªï¼Œæ€»å…±ä¸åˆ° 40 å—é’±ã€‚&lt;/p&gt;

&lt;p&gt;æœ€ç»ˆåˆ°æ‰‹å°±æ˜¯è¿™ä¸ªå•¦ï¼š
&lt;center&gt;&lt;img src=&#34;http://sysfork.com/img/2017/nodemcu/nodemc-board.png&#34; width=&#34;450px&#34;&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;è¿™å—æ¿å­ç›´æ¥æ”¯æŒ microUSB æ¥å£ï¼Œä¸ç”¨è‡ªå·±ä½¿ç”¨ USB-TTL æ¥è¿äº†ï¼Œçœäº†ä¸å°‘éº»çƒ¦ã€‚è¿æ¥ç”µè„‘åï¼ˆæ³¨æ„æœ‰äº›USBçº¿åªæ”¯æŒå……ç”µï¼Œæˆ‘æ‰¾äº†ä¸¤æ¡çº¿éƒ½ç”¨ä¸äº†ï¼Œæ¢äº†ç¬¬ä¸‰æ ¹æ•°æ®çº¿æ‰è„¸ä¸Šï¼‰ï¼Œä¼šè‡ªåŠ¨å®‰è£…
é©±åŠ¨ï¼Œç³»ç»Ÿä¼šæ˜¾ç¤ºå¤šäº†ä¸€ä¸ª COM å£ã€‚&lt;/p&gt;

&lt;p&gt;&lt;center&gt;&lt;img src=&#34;http://sysfork.com/img/2017/nodemcu/devicemanager.png&#34; width=&#34;450px&#34;&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;è¿æ¥ä¸Šç”µè„‘åç¬¬ä¸€ä»¶äº‹å°±æ˜¯åˆ·æœºï¼Œè¿™é‡Œæ˜¯å›ºä»¶çš„åœ°å€ &lt;a href=&#34;https://github.com/nodemcu/nodemcu-firmware&#34;&gt;https://github.com/nodemcu/nodemcu-firmware&lt;/a&gt;ï¼Œ å½“ç„¶ä½ ä¹Ÿå¯ä»¥åˆ·
&lt;a href=&#34;https://docs.micropython.org/en/latest/esp8266/esp8266/tutorial/intro.html&#34;&gt;MicroPython&lt;/a&gt;ã€‚ç”±äºå›ºä»¶ç¼–è¯‘ç¯å¢ƒæ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥æœ‰çˆ±å¥½è€…åšäº†ä¸€ä¸ªåœ¨çº¿ç¼–è¯‘çš„ç½‘ç«™
&lt;a href=&#34;https://nodemcu-build.com/&#34;&gt;https://nodemcu-build.com/&lt;/a&gt;ï¼Œä½ å¯ä»¥é€‰æ‹©åˆ†æ”¯å’Œæ¨¡å—ï¼Œå®ç°å®šåˆ¶ã€‚æäº¤ä»»åŠ¡åï¼Œå½“å®ƒå¼€å§‹ç¼–è¯‘å’Œç»“æŸç¼–è¯‘çš„æ—¶å€™ä¼šå‘é€é‚®ä»¶ç»™ä½ ç•™ä¸‹çš„é‚®ç®±ã€‚åŒæ—¶ï¼Œä¼šæ¨èä¸€ä¸ª
 flash å·¥å…·ï¼Œå…¶å®å°±æ˜¯ pyflasher çš„ GUI ç‰ˆï¼Œä½ å¯ä»¥ä¸‹è½½ä¸‹æ¥ä½¿ç”¨ã€‚æ¥ä¸‹æ¥å¯åŠ¨è¿™ä¸ªå·¥å…·ï¼š&lt;/p&gt;

&lt;p&gt;&lt;center&gt;&lt;img src=&#34;http://sysfork.com/img/2017/nodemcu/pyflash.png&#34; width=&#34;450px&#34;&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;ç”±äºæˆ‘ä¹°çš„è¿™ä¸ªæ¿å­˜å‚¨è¶…è¿‡4Mï¼Œæ‰€ä»¥é€‰æ‹©çš„æ˜¯ DIO æ¨¡å¼ï¼ŒåŒæ—¶ç”±äºæ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œæ‰€ä»¥ç›´æ¥é€‰æ‹©æ¸…é™¤æ‰€æœ‰æ•°æ®ã€‚åˆ·æœºå¾ˆå¿«ï¼Œä¸åˆ°1minã€‚ä¹‹åå°±å¯ä»¥ä½¿ç”¨å•¦ã€‚&lt;/p&gt;

&lt;p&gt;IDE æˆ‘é€‰æ‹©çš„æ˜¯&lt;a href=&#34;https://esp8266.ru/esplorer&#34;&gt;ESPlorer&lt;/a&gt;ï¼Œå®ƒåŒæ—¶æ”¯æŒ lua å’Œ MicroPython ç¼–ç¨‹ã€‚æ‰“å¼€ä¸»ç•Œé¢åç›´æ¥ç‚¹å‡»å³ä¸Šè§’çš„ Connect å°±å¯ä»¥äº†ï¼Œç„¶åæŒ‰ä¸€ä¸‹æ¿å­ä¸Šçš„
 RST æŒ‰é’®å°±èƒ½è¿›å…¥ lua çš„ REPL ç¯å¢ƒäº†ã€‚å¯ä»¥åœ¨ä¸‹é¢è¾“å…¥ lua ä»£ç æ‰§è¡Œï¼Œå°±è·Ÿæ™®é€šçš„ lua äº¤äº’å¼ç¯å¢ƒä¸€æ ·ã€‚ä¸‹é¢æ˜¯å¦‚ä½•è¿æ¥ wifi çš„ä»£ç &lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;wifi.setmode(wifi.STATION)
wifi.sta.config({ssid=&amp;quot;SSID_NAME&amp;quot;, pwd=&amp;quot;PASSWORD&amp;quot;})
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å…¶ä¸­ wifi æ˜¯ä¸€ä¸ªå†…ç½®æ¨¡å—ï¼Œæ‰€æœ‰çš„å†…ç½®æ¨¡å—éƒ½å¯ä»¥åœ¨ç¼–è¯‘çš„æ—¶å€™é€‰ä¸­ï¼Œæ¨¡å—çš„ä½¿ç”¨æ–‡æ¡£ï¼š&lt;a href=&#34;https://nodemcu.readthedocs.io&#34;&gt;https://nodemcu.readthedocs.io&lt;/a&gt;ã€‚ æ¯”å¦‚è¯´æƒ³è·å–æŸä¸ªç½‘å€çš„å†…å®¹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;http.get(&amp;quot;http://baidu.com&amp;quot;, nil, function(code, data)
    print(code, data)
end)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;NodeMCU é‡‡ç”¨äº†ä¸€ç§äº‹ä»¶è§¦å‘æ¨¡å‹ï¼Œæ‰€ä»¥å¾ˆå¤šè¿™ç§å›è°ƒå‡½æ•°ï¼Œç±»ä¼¼äº Node.jsã€‚&lt;/p&gt;

&lt;p&gt;NodeMCU æä¾›äº†å¾ˆå¤š GPIO å£ï¼Œä½¿å¾—å®ƒæˆä¸º IoT å¼€å‘çš„é¦–é€‰æ–¹æ¡ˆï¼Œå¯ä»¥è¿æ¥å„ç§ä¼ æ„Ÿå™¨ã€‚æˆ‘å°è¯•äº†ä¸€ä¸‹æ¸©åº¦ä¼ æ„Ÿå™¨ DHT11 æ¨¡å—ï¼Œå•†å®¶ç›´æ¥å°è£…å¥½äº†ï¼Œä¸ç”¨è‡ªå·±å†æ¥ä¸Šæ‹‰ç”µé˜»äº†ã€‚å¦‚æœç›´æ¥é€šè¿‡ç¼–ç¨‹æ¥è¯»å–
æ¸©åº¦å’Œæ¹¿åº¦æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œå¥½åœ¨å†…ç½®æ¨¡å—æä¾›äº† DHT æ¨¡å—ï¼Œåªè¦åœ¨ç¼–è¯‘çš„æ—¶å€™åŒ…å«è¿›å»å°±å¯ä»¥ã€‚æœ€åä»£ç å¦‚ä¸‹(ä»æ–‡æ¡£æ‘˜å–çš„)ï¼Œå…¶ä¸­ 5 æ˜¯ä¿¡å·è¾“å…¥æºï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;pin = 5
status, temp, humi, temp_dec, humi_dec = dht.read(pin)
if status == dht.OK then
    -- Integer firmware using this example
    print(string.format(&amp;quot;DHT Temperature:%d.%03d;Humidity:%d.%03d\r\n&amp;quot;,
          math.floor(temp),
          temp_dec,
          math.floor(humi),
          humi_dec
    ))

    -- Float firmware using this example
    print(&amp;quot;DHT Temperature:&amp;quot;..temp..&amp;quot;;&amp;quot;..&amp;quot;Humidity:&amp;quot;..humi)

elseif status == dht.ERROR_CHECKSUM then
    print( &amp;quot;DHT Checksum error.&amp;quot; )
elseif status == dht.ERROR_TIMEOUT then
    print( &amp;quot;DHT timed out.&amp;quot; )
end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é™¤äº†å°è¯• DHT11 æ¨¡å—å¤–ï¼Œè¿˜è¯•äº†ä¸€ä¸‹è¶…å£°æ³¢æ¨¡å— HC-SR04ï¼Œ è¿™ä¸ªæ˜¯é€šè¿‡å‘ Trig ç«¯è¾“å‡ºä¸€æ®µé«˜ç”µå¹³ä¿¡å·ï¼Œç„¶åé€šè¿‡ Echo ç«¯æ¥æ£€æµ‹é«˜ç”µå¹³ï¼Œé«˜ç”µå¹³çš„æŒç»­æ—¶é—´å°±æ˜¯è¶…å£°æ³¢ä¼ è¾“çš„æ—¶é—´ï¼Œç„¶åæ ¹æ®
ç©ºæ°”ä¸­çš„å£°é€Ÿå°±èƒ½è®¡ç®—å‡ºæ¥äº†ã€‚å¥½åœ¨ä¹Ÿæœ‰äººæä¾›äº†ä¸€ä¸ªå¼€æºä»£ç  &lt;a href=&#34;https://github.com/sza2/node_hcsr04/&#34;&gt;https://github.com/sza2/node_hcsr04/&lt;/a&gt;ã€‚ä½†æ˜¯å®é™…ä½¿ç”¨å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•ã€‚
æˆ‘ä»¬æ¥çœ‹çœ‹ä»–çš„ä»£ç ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;function self.echo_cb(level)
    if level == 1 then
        self.time_start = tmr.now()
        gpio.trig(self.echo, &amp;quot;down&amp;quot;)
    else
        self.time_end = tmr.now()
    end
end

function self.measure()
    gpio.trig(self.echo, &amp;quot;up&amp;quot;, self.echo_cb)
    gpio.write(self.trig, gpio.HIGH)
    tmr.delay(100)
    gpio.write(self.trig, gpio.LOW)
    tmr.delay(100000)
    if (self.time_end - self.time_start) &amp;lt; 0 then
        return -1
    end
    return (self.time_end - self.time_start) / 5800
end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é€»è¾‘å¾ˆç®€å•ï¼Œå…ˆæ˜¯é€šè¿‡ç›‘å¬ä½åˆ°é«˜è½¬æ¢çš„ä¿¡å·ï¼Œè®°å½•æ—¶é—´åŒæ—¶ç›‘å¬é«˜åˆ°åœ°çš„ä¿¡å·ï¼Œè®°å½•æ—¶é—´ï¼Œè¿™ä¸ªæ—¶é—´å·®å€¼å°±æ˜¯è¶…å£°æ³¢çš„ä¼ è¾“æ—¶é—´ã€‚ä½†æ˜¯ç”±äºè¶…å£°æ³¢çš„é€Ÿåº¦å¾ˆå¿«ï¼Œå¾ˆæœ‰å¯èƒ½ä½ åœ¨è®¾ç½® down
äº‹ä»¶ä¹‹å‰å·²ç»è§¦å‘äº†ï¼Œå¯¼è‡´è¿Ÿè¿Ÿæ— æ³•è·å–ç»“æŸä¿¡å·ã€‚æ‰€ä»¥å¯ä»¥ç¨ä½œæ”¹åŠ¨&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;function self.echo_cb(level)
    if level == 1 then
        self.time_start = tmr.now()
    else
        self.time_end = tmr.now()
    end
end
function self.measure()
    gpio.trig(self.echo, &amp;quot;both&amp;quot;, self.echo_cb)
    gpio.write(self.trig, gpio.HIGH)
    tmr.delay(100)
    gpio.write(self.trig, gpio.LOW)
    tmr.delay(100000)
    if (self.time_end - self.time_start) &amp;lt; 0 then
        return -1
    end
    return (self.time_end - self.time_start) / 5800
end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç„¶åå‘ç°éƒ¨åˆ†èƒ½æ­£å¸¸ä½¿ç”¨äº†ï¼Œä½†æ˜¯å¯¹äºçŸ­è·ç¦»çš„æµ‹é‡è¿˜æ˜¯ä¼šä¸¢å¤±ç»“æŸä¿¡å·ï¼ŒçŒœæƒ³å¯èƒ½æ˜¯åœ¨ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­äº‹ä»¶åˆ°æ¥ï¼Œç»“æœæ²¡èƒ½æ¥å¾—åŠå¤„ç†ï¼Œæ‰€ä»¥åªèƒ½é‡‡å–æ¯”è¾ƒè€åœŸçš„æ–¹æ¡ˆäº†ï¼Œä¸ä½¿ç”¨äº‹ä»¶é©±åŠ¨ï¼Œç›´æ¥è¯»&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lua&#34;&gt;function self.measure()
    gpio.write(self.trig, gpio.HIGH)
    tmr.delay(100)
    gpio.write(self.trig, gpio.LOW)
    gpio.mode(self.echo, gpio.INPUT)
    gpio.write(self.echo, gpio.LOW)
    local start_time, end_time
    local gread = gpio.read
    local tnow = tmr.now
    local echo = self.echo
    local wdclr = tmr.wdclr
    while gread(echo) == 1 do
        start_time = tnow()
        wdclr()
    end
    while gread(echo) == 0 do
        end_time = tnow()
        wdclr()
    end
    return (end_time - start_time) / 5800
end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æœ€ç»ˆçš„æ•ˆæœè¿˜ä¸é”™ï¼Œå¯¹äºå‡ å˜ç±³çš„è·ç¦»ä¹Ÿèƒ½æœ‰å¾ˆå¥½çš„åˆ†è¾¨ç‡ã€‚&lt;/p&gt;

&lt;p&gt;æ€»çš„æ¥è¯´ï¼Œ NodeMCU çš„å¯ç©æ€§éå¸¸å¼ºï¼Œæ¯”å¦‚è¯´å¯ä»¥é€šè¿‡ç½‘ç»œå’Œç»§ç”µå™¨å®ç°å®¶åº­ç”µå™¨å¼€å…³çš„æ§åˆ¶å•¦ï¼Œç®€ç›´å°±æ˜¯ç¡¬ä»¶ç‰ˆçš„ IFTTTï¼Œç›¸æ¯”äºæ ‘è“æ´¾ï¼Œä»·æ ¼å¤Ÿä¾¿å®œï¼Œç®€ç›´å°±æ˜¯æŠ˜è…¾æ™ºèƒ½å®¶åº­çš„ç¥å™¨ã€‚&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>